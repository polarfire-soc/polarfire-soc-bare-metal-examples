; Tera Term Setting:
; 1. Before running Tera Term Macro script, you should set language as English 
;   and transmit delay in Serial port setup to 5msec/char and 5msec/line.
; 2. By default, Tera Term log will be stored in Tera Term installation Directory.

changedir '.'
logopen "rsa_services.log" 0 0 0 1

settitle 'PolarFire SoC MSS User Crypto RSA service'

setsync 1

;Clear screen
clearscreen 0

; Set baud rate to 115200
setbaud 115200

; local echo off
setecho 0

;Press any key
send 13
pause 2

; ------------------------------------------------------------------------------
;RSA Sig Gen
; INPUT
; Msg =
;     c43011f3ee88c9c9adcac8bf37221afa31769d347dec705e53aca98993e74606591867ccd2
;     89ba1b4f19365f983e0c578346da76c5e2228a07e4fc9b3d4807163371a52b68b66873201d
;     c7d6b56616ac2e4cb522120787df7f15a5e8763a54c179c635d65816bc19485de3eb35a520
;     40591094fe0e6485a7e0c60e38e7c61551

; d =
;     0997634c477c1a039d44c810b2aaa3c7862b0b88d3708272e1e15f66fc9389709f8a11f3ea
;     6a5af7effa2d01c189c50f0d5bcbe3fa272e56cfc4a4e1d388a9dcd65df8628902556c8b6b
;     b6a641709b5a35dd2622c73d4640bfa1359d0e76e1f219f8e33eb9bd0b59ec198eb2fccaae
;     0346bd8b401e12e3c67cb629569c185a2e0f35a2f741644c1cca5ebb139d77a89a2953fc5e
;     30048c0e619f07c8d21d1e56b8af07193d0fdf3f49cd49f2ef3138b5138862f1470bd2d16e
;     34a2b9e7777a6c8c8d4cb94b4e8b5d616cd5393753e7b0f31cc7da559ba8e98d888914e334
;     773baf498ad88d9631eb5fe32e53a4145bf0ba548bf2b0a50c63f67b14e398a34b0d

; n =
;     cea80475324c1dc8347827818da58bac069d3419c614a6ea1ac6a3b510dcd72cc516954905
;     e9fef908d45e13006adf27d467a7d83c111d1a5df15ef293771aefb920032a5bb989f8e4f5
;     e1b05093d3f130f984c07a772a3683f4dc6fb28a96815b32123ccdd13954f19d5b8b24a103
;     e771a34c328755c65ed64e1924ffd04d30b2142cc262f6e0048fef6dbc652f21479ea1c4b1
;     d66d28f4d46ef7185e390cbfa2e02380582f3188bb94ebbf05d31487a09aff01fcbb4cd4bf
;     d1f0a833b38c11813c84360bb53c7d4481031c40bad8713bb6b835cb08098ed15ba31ee4ba
;     728a8c8e10f7294e1b4163b7aee57277bfd881a6f9d43e02c6925aa3a043fb7fb78d

; OUTPUT
; Generated Signature value =
;     aa3a4e12eb87596c711c9a22bcabcb9dadffcabcecbd16228889e9bb457d5d22571a72f034
;     be4783384f43ce6fffc60534b8331cdd5d7c77f49180bfd194b5fd43a508c66d786c558876
;     735894e6a9300952de792f747045e74d87fd50980230707a34a4df013ce050bbff0d6f5708
;     85c9c7bf8dc499132caee071b41d81ff91b8ce21aa2f282cbf52389f239afe1490890be21f
;     9d808b3d70b97efd59c0b60e466088bb42714f212bc90db7e942ebcee60e7b107fff44fb35
;     64ff07d6d02850215fd357d897c4d32bef8661689f2d84ff897637fb6d5568a7270e783426
;     b74b7037493e5155fd7cb3ddddfd36bd8a9c877d71d2a966057c08263d2939c84987
; ------------------------------------------------------------------------------
;                            RSA Signature Generation 
; ------------------------------------------------------------------------------

; select signature generation
send '1'
pause 1

; select RSASSA-PKCS1-v1.5
send '2'
pause 1

; select SHA-256 Algorithm
send '3'
pause 1

; Msg
send 'c43011f3ee88c9c9adcac8bf37221afa31769d347dec705e53aca98993e74606591867ccd2'
send '89ba1b4f19365f983e0c578346da76c5e2228a07e4fc9b3d4807163371a52b68b66873201d'
send 'c7d6b56616ac2e4cb522120787df7f15a5e8763a54c179c635d65816bc19485de3eb35a520'
send '40591094fe0e6485a7e0c60e38e7c61551'
pause 1

; d
send '0997634c477c1a039d44c810b2aaa3c7862b0b88d3708272e1e15f66fc9389709f8a11f3ea'
send '6a5af7effa2d01c189c50f0d5bcbe3fa272e56cfc4a4e1d388a9dcd65df8628902556c8b6b'
send 'b6a641709b5a35dd2622c73d4640bfa1359d0e76e1f219f8e33eb9bd0b59ec198eb2fccaae'
send '0346bd8b401e12e3c67cb629569c185a2e0f35a2f741644c1cca5ebb139d77a89a2953fc5e'
send '30048c0e619f07c8d21d1e56b8af07193d0fdf3f49cd49f2ef3138b5138862f1470bd2d16e'
send '34a2b9e7777a6c8c8d4cb94b4e8b5d616cd5393753e7b0f31cc7da559ba8e98d888914e334'
send '773baf498ad88d9631eb5fe32e53a4145bf0ba548bf2b0a50c63f67b14e398a34b0d'
pause 1

; n
send 'cea80475324c1dc8347827818da58bac069d3419c614a6ea1ac6a3b510dcd72cc516954905'
send 'e9fef908d45e13006adf27d467a7d83c111d1a5df15ef293771aefb920032a5bb989f8e4f5'
send 'e1b05093d3f130f984c07a772a3683f4dc6fb28a96815b32123ccdd13954f19d5b8b24a103'
send 'e771a34c328755c65ed64e1924ffd04d30b2142cc262f6e0048fef6dbc652f21479ea1c4b1'
send 'd66d28f4d46ef7185e390cbfa2e02380582f3188bb94ebbf05d31487a09aff01fcbb4cd4bf'
send 'd1f0a833b38c11813c84360bb53c7d4481031c40bad8713bb6b835cb08098ed15ba31ee4ba'
send '728a8c8e10f7294e1b4163b7aee57277bfd881a6f9d43e02c6925aa3a043fb7fb78d'
pause 10

timeout = 30
wait
;; Send Dummy
send '3'
pause 1
pause 10

;-------------------------------------------------------------------------------
;                                   signature verification
;-------------------------------------------------------------------------------

; select signature verification
send '2'
pause 1

; select RSASSA-PKCS1-v1.5
send '2'
pause 1

; select SHA-256 Algorithm
send '3'
pause 1

; Msg
send 'c43011f3ee88c9c9adcac8bf37221afa31769d347dec705e53aca98993e74606591867ccd2'
send '89ba1b4f19365f983e0c578346da76c5e2228a07e4fc9b3d4807163371a52b68b66873201d'
send 'c7d6b56616ac2e4cb522120787df7f15a5e8763a54c179c635d65816bc19485de3eb35a520'
send '40591094fe0e6485a7e0c60e38e7c61551'
pause 1

; Public exponent value
send '00000000000000000000000000000000000000000000000000000000000000000000000000'
send '00000000000000000000000000000000000000000000000000000000000000000000000000'
send '00000000000000000000000000000000000000000000000000000000000000000000000000'
send '00000000000000000000000000000000000000000000000000000000000000000000000000'
send '00000000000000000000000000000000000000000000000000000000000000000000000000'
send '00000000000000000000000000000000000000000000000000000000000000000000000000'
send '00000000000000000000000000000000000000000000000000000000000000260445'
pause 1

; modulus n
send 'cea80475324c1dc8347827818da58bac069d3419c614a6ea1ac6a3b510dcd72cc516954905'
send 'e9fef908d45e13006adf27d467a7d83c111d1a5df15ef293771aefb920032a5bb989f8e4f5'
send 'e1b05093d3f130f984c07a772a3683f4dc6fb28a96815b32123ccdd13954f19d5b8b24a103'
send 'e771a34c328755c65ed64e1924ffd04d30b2142cc262f6e0048fef6dbc652f21479ea1c4b1'
send 'd66d28f4d46ef7185e390cbfa2e02380582f3188bb94ebbf05d31487a09aff01fcbb4cd4bf'
send 'd1f0a833b38c11813c84360bb53c7d4481031c40bad8713bb6b835cb08098ed15ba31ee4ba'
send '728a8c8e10f7294e1b4163b7aee57277bfd881a6f9d43e02c6925aa3a043fb7fb78d'
pause 4

logclose