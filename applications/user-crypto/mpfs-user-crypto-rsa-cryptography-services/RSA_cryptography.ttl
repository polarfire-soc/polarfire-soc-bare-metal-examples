; Tera Term Setting:
; 1. Before running Tera Term Macro script, you should set language as English 
;   and transmit delay in Serial port setup to 5msec/char and 5msec/line.
; 2. By default, Tera Term log will be stored in Tera Term installation Directory.

changedir '.'
logopen "RSA_Cryptography.log" 0 0 0 1

settitle 'PolarFire SOC User Crypto RSA Crypto service'

setsync 1

;Clear screen
clearscreen 0

; Set baud rate to 115200
setbaud 115200

; local echo off
setecho 0

send 13
pause 2

; ----------------------------------------------------------------------------------------------------------------------------------------------------------
; RSA Encryption
; INPUT
;     msg = 
;      657874736f6e207479707469456e6372697468206e74207772696d656578706520746f20
;      77616e7477686f206f7365206c2074687220616c6c20666f736566756c79207568696768
;      2062652077696c6c696e6720207374725468697369742e20666f72206c7365206e672065
;      797468696f20616e746f2064656564202774206e20646f6e642077656520616e2066696e
;      6f726b733732207741203330742052532074686176696e672070726f6c20696e73656675
;      62652075696c6c20697420776c6c7920706566752e20486f7468697320646f206520746f
;      6f77206d20616c6c6f756c6461742077652074687373616767206d65206c6f6e74652061
;      6372656120746f2079696e676d20747220492061656e6365732e2048737375656e792069
;      757420616974686f6c7920777265637420636f7270746564656372796265206474657220
;      6e206c6174206361617420696f20746865642073727970746520656e746f206265647320
;      65206e65652074687373616761206d652069732054686973
;     n = 
;      8e1a97593b3adf945529c78997ed0bca70b04f410bf64db50c2754a6ad2cb9b752d0d5e4
;      2a496b00df4a0836b6ae5e80e4b4aecde54f556459bdc01c0dc72343d32ae8beaf490519
;      e7aa351fbb154b47f8e7fa9e29b97e6b0832c35085c20c00d4046ed687cd1701348a69de
;      858424aa3c98b1ca3cab4ae8341aa2f02f78603794c6c454ac9c6c751fda472250d7efda
;      bb84522da75750c044e5105330fdaddc9ce9fa55e2ffe0f4ddaf8adc1786526e22a58242
;      f6668a0fcd98b9477e5fe304626bfb9ed86f5997393fe230f1bb404a6b5cc69718fa5552
;      c6ae147bf381750dc7fcd7e420d150455502408cd0e7636735ede40f55f946a5b6a643fb
;      9f90f54ce7276e2b04f08d1a1759534bbfbeada60932c2321b7bc5986c08b3a7ae8b61b4
;      595ddd16558961a9dc82b0e9f70e0d4c9ada379f7e7b51a12af6fe2631ac2afb165ac45c
;      db329c8c8df45d6b6c4123782a8f50f69d44bc9fc52a6b92e635bcda279f1c9e0f902964
;      63762849dd2a069073cdba018497a60ea97bf561d8d379d1
;     e = 00010001

; OUTPUT
;     Cipher text = 
;      fa0c027cfd836d2c9e90dd3b8d69596f49db7b63237a209b3a627601cbb8828c074edfff
;      1f40f770f9774a38b0e55fc801f643f393c3afc86c361fad1669ef599abfea16dd43e752
;      fb75675d3b2a1c4f9a521b475513970b9fa2494a42e038dac5c5d0989a65a9e211f65132
;      4cf0dfb89e0bae3c7b0c6b884637b6d29e0e4b526bf248ea9f97c71eeafa9d5ef1de894f
;      978ed0571eb64d40ca3da83023128e82df0f6fa19d97c9640b862782e5768474093d9c8c
;      f6ad159c77e6fd2b68de7fac12cea60eac0056aa38b3840b465cb4b961a6ff00b7c723c9
;      1602a9bbc99b5f1594b4d2457fa0d4f644cf08f1b3d41f2b5cb7de02e3f2c0540c63ab78
;      fa716c34fbda85b8c9d540d8d45c636895400b8b746abe42db906e2e54addbcd0fb69056
;      d63c48b4e42ad0255aa67aefdea02c4bb8b69a068921aaf5f330e48b0c5df1e4c6da190f
;      5003ed0c6be09f787419cdea9b5f581eccf9f6b58741631998d776c3cc1a4d91f7ffe87c
;      6bb3bf8f1df4d03ae43477e7e90d2f4dd98e5ba248f284c7
; ----------------------------------------------------------------------------------------------------------------------------------------------------------

pause 1
send '1'

;Message = 128 Bytes
pause 1
send '657874736f6e207479707469456e6372'
send '697468206e74207772696d6565787065'
send '20746f2077616e7477686f206f736520'
send '6c2074687220616c6c20666f73656675'
send '6c792075686967682062652077696c6c'
send '696e6720207374725468697369742e20'
send '666f72206c7365206e67206579746869'
send '6f20616e746f2064656564202774206e'
send '20646f6e642077656520616e2066696e'
send '6f726b73373220774120333074205253'
send '2074686176696e672070726f6c20696e'
send '7365667562652075696c6c2069742077'
send '6c6c7920706566752e20486f74686973'
send '20646f206520746f6f77206d20616c6c'
send '6f756c64617420776520746873736167'
send '67206d65206c6f6e7465206163726561'
send '20746f2079696e676d20747220492061'
send '656e6365732e2048737375656e792069'
send '757420616974686f6c79207772656374'
send '20636f72707465646563727962652064'
send '746572206e206c617420636161742069'
send '6f20746865642073727970746520656e'
send '746f20626564732065206e6565207468'
send '7373616761206d652069732054686973'
pause 5

;n = 256 bytes
send '8e1a97593b3adf945529c78997ed0bca'
send '70b04f410bf64db50c2754a6ad2cb9b7'
send '52d0d5e42a496b00df4a0836b6ae5e80'
send 'e4b4aecde54f556459bdc01c0dc72343'
send 'd32ae8beaf490519e7aa351fbb154b47'
send 'f8e7fa9e29b97e6b0832c35085c20c00'
send 'd4046ed687cd1701348a69de858424aa'
send '3c98b1ca3cab4ae8341aa2f02f786037'
send '94c6c454ac9c6c751fda472250d7efda'
send 'bb84522da75750c044e5105330fdaddc'
send '9ce9fa55e2ffe0f4ddaf8adc1786526e'
send '22a58242f6668a0fcd98b9477e5fe304'
send '626bfb9ed86f5997393fe230f1bb404a'
send '6b5cc69718fa5552c6ae147bf381750d'
send 'c7fcd7e420d150455502408cd0e76367'
send '35ede40f55f946a5b6a643fb9f90f54c'
send 'e7276e2b04f08d1a1759534bbfbeada6'
send '0932c2321b7bc5986c08b3a7ae8b61b4'
send '595ddd16558961a9dc82b0e9f70e0d4c'
send '9ada379f7e7b51a12af6fe2631ac2afb'
send '165ac45cdb329c8c8df45d6b6c412378'
send '2a8f50f69d44bc9fc52a6b92e635bcda'
send '279f1c9e0f90296463762849dd2a0690'
send '73cdba018497a60ea97bf561d8d379d1'

;e
pause 5
send '00010001'
send 13
pause 5
send 13
pause 5
; ----------------------------------------------------------------------------------------------------------------------------------------------------------
; RSA Decryption
; INPUT
;     Cipher text =
;      fa0c027cfd836d2c9e90dd3b8d69596f49db7b63237a209b3a627601cbb8828c074edfff1
;      f40f770f9774a38b0e55fc801f643f393c3afc86c361fad1669ef599abfea16dd43e752fb
;      75675d3b2a1c4f9a521b475513970b9fa2494a42e038dac5c5d0989a65a9e211f651324cf
;      0dfb89e0bae3c7b0c6b884637b6d29e0e4b526bf248ea9f97c71eeafa9d5ef1de894f978e
;      d0571eb64d40ca3da83023128e82df0f6fa19d97c9640b862782e5768474093d9c8cf6ad1
;      59c77e6fd2b68de7fac12cea60eac0056aa38b3840b465cb4b961a6ff00b7c723c91602a9
;      bbc99b5f1594b4d2457fa0d4f644cf08f1b3d41f2b5cb7de02e3f2c0540c63ab78fa716c3
;      4fbda85b8c9d540d8d45c636895400b8b746abe42db906e2e54addbcd0fb69056d63c48b4
;      e42ad0255aa67aefdea02c4bb8b69a068921aaf5f330e48b0c5df1e4c6da190f5003ed0c6
;      be09f787419cdea9b5f581eccf9f6b58741631998d776c3cc1a4d91f7ffe87c6bb3bf8f1d
;      f4d03ae43477e7e90d2f4dd98e5ba248f284c7
;     Private key = 
;      c8f79e0138e6d31ae9c5303de1d838a997f99441e1c210d01e42de9f4af06122a21e7c7e7
;      9fbdc624f0b90751165e4d0f075842ee659875bb35569035508bc3938f31e69766b856ba4
;      90ecd37e5665e47d522647fd7fe7350a58bd92431fb423c83561694d419eea51ac3159b7b
;      c2274ba2624801c819e4649fc55a80b4f1c30ff080e778cff797e16e564158e80a0334d0f
;      321f5d1361bc636201f8fedd87a46a80e7f2eeb02a8a0717deaba8619b27c0b081e0e45a4
;      314dd44df6d4139f06d4697e353b26cece2b011284111eef9ea2dfb7a693560e460012d87
;      f16c096775d12ec643183f32b163407c832e8b57c5dacbacfa2afbe277bbb259d03442538
;      3efe2fe65427546757b462dd06864ba3a4c9d1e0a6afb45d64e20c9e06ad760c2dee92a7c
;      3027d17848f802e2fd5569a4ac39835c883e92299074f4845cb1547af3e4da54ef592fec7
;      0ea4ba85336d5f4a95f8ca906e8b0f6441276eecae77039a3ca094bff42b6341fc6effe93
;      07bee7fcafafcfd60eb77d65c717541377892c
;     P = 
;      2d05e449f1cdfba2602176a59719daeeb5ce0ec32d1c359ac5b13a811c116c2513caaa800
;      bbd34a8a881558f1e9590d0ae020bcc97ff94cae7f6c6d3a15b75507a6842eda2197c9947
;      498612074d6e4ae882130977b73f810a25f8ff84ae213b50099c8368f54ad63fb72dd89c0
;      7438e4cf3e0be2f214ba88a86c2c6a2ef215a77335f5e91f1853efd3ff6863980efc53e35
;      4d45fce1a2fc1a72e49ac29cdfaa5a9866ee58455406cbd6e95310cb75a850fbf2fd84299
;      554adfeea06f303642e
;     Q = 
;      cc2dfa91c81e3a5e18bf7bc4a025660592c31718e3fcf6661d8560da9156a4ff1fd2e4012
;      75d7805f8a90bb64c0c00c15e23bab155c6e3b15c68fb5108f5751b4c79ee31411759910d
;      40c68773a7a84dec371b8cfefa8ebb3139850f33da584ae9c7ef194a9259fc28246028e9c
;      c7d8b00a939dc1c6e347de111050a7361c32629a00896638ac5de4e438484d749d495d50a
;      d59ffa59e2afa82a95c6caf09ec6a3facd2eb2674f62fb1899046c9d1f92cdc7619fe0ea5
;      0d5ee3b1b2fe469d2e6
;     e = 
;      00010001
;     n = 
;      8e1a97593b3adf945529c78997ed0bca70b04f410bf64db50c2754a6ad2cb9b752d0d5e42
;      a496b00df4a0836b6ae5e80e4b4aecde54f556459bdc01c0dc72343d32ae8beaf490519e7
;      aa351fbb154b47f8e7fa9e29b97e6b0832c35085c20c00d4046ed687cd1701348a69de858
;      424aa3c98b1ca3cab4ae8341aa2f02f78603794c6c454ac9c6c751fda472250d7efdabb84
;      522da75750c044e5105330fdaddc9ce9fa55e2ffe0f4ddaf8adc1786526e22a58242f6668
;      a0fcd98b9477e5fe304626bfb9ed86f5997393fe230f1bb404a6b5cc69718fa5552c6ae14
;      7bf381750dc7fcd7e420d150455502408cd0e7636735ede40f55f946a5b6a643fb9f90f54
;      ce7276e2b04f08d1a1759534bbfbeada60932c2321b7bc5986c08b3a7ae8b61b4595ddd16
;      558961a9dc82b0e9f70e0d4c9ada379f7e7b51a12af6fe2631ac2afb165ac45cdb329c8c8
;      df45d6b6c4123782a8f50f69d44bc9fc52a6b92e635bcda279f1c9e0f90296463762849dd
;      2a069073cdba018497a60ea97bf561d8d379d1

; OUTPUT
;     Decrypted msg = 
;      657874736f6e207479707469456e6372697468206e74207772696d656578706520746f20
;      77616e7477686f206f7365206c2074687220616c6c20666f736566756c79207568696768
;      2062652077696c6c696e6720207374725468697369742e20666f72206c7365206e672065
;      797468696f20616e746f2064656564202774206e20646f6e642077656520616e2066696e
;      6f726b733732207741203330742052532074686176696e672070726f6c20696e73656675
;      62652075696c6c20697420776c6c7920706566752e20486f7468697320646f206520746f
;      6f77206d20616c6c6f756c6461742077652074687373616767206d65206c6f6e74652061
;      6372656120746f2079696e676d20747220492061656e6365732e2048737375656e792069
;      757420616974686f6c7920777265637420636f7270746564656372796265206474657220
;      6e206c6174206361617420696f20746865642073727970746520656e746f206265647320
;      65206e65652074687373616761206d652069732054686973
       
; ----------------------------------------------------------------------------------------------------------------------------------------------------------
pause 10
send '2'
pause 5
;decrypted message
send 'fa0c027cfd836d2c9e90dd3b8d69596f'
send '49db7b63237a209b3a627601cbb8828c'
send '074edfff1f40f770f9774a38b0e55fc8'
send '01f643f393c3afc86c361fad1669ef59'
send '9abfea16dd43e752fb75675d3b2a1c4f'
send '9a521b475513970b9fa2494a42e038da'
send 'c5c5d0989a65a9e211f651324cf0dfb8'
send '9e0bae3c7b0c6b884637b6d29e0e4b52'
send '6bf248ea9f97c71eeafa9d5ef1de894f'
send '978ed0571eb64d40ca3da83023128e82'
send 'df0f6fa19d97c9640b862782e5768474'
send '093d9c8cf6ad159c77e6fd2b68de7fac'
send '12cea60eac0056aa38b3840b465cb4b9'
send '61a6ff00b7c723c91602a9bbc99b5f15'
send '94b4d2457fa0d4f644cf08f1b3d41f2b'
send '5cb7de02e3f2c0540c63ab78fa716c34'
send 'fbda85b8c9d540d8d45c636895400b8b'
send '746abe42db906e2e54addbcd0fb69056'
send 'd63c48b4e42ad0255aa67aefdea02c4b'
send 'b8b69a068921aaf5f330e48b0c5df1e4'
send 'c6da190f5003ed0c6be09f787419cdea'
send '9b5f581eccf9f6b58741631998d776c3'
send 'cc1a4d91f7ffe87c6bb3bf8f1df4d03a'
send 'e43477e7e90d2f4dd98e5ba248f284c7'
pause 5

;private key D
send 'c8f79e0138e6d31ae9c5303de1d838a9'
send '97f99441e1c210d01e42de9f4af06122'
send 'a21e7c7e79fbdc624f0b90751165e4d0'
send 'f075842ee659875bb35569035508bc39'
send '38f31e69766b856ba490ecd37e5665e4'
send '7d522647fd7fe7350a58bd92431fb423'
send 'c83561694d419eea51ac3159b7bc2274'
send 'ba2624801c819e4649fc55a80b4f1c30'
send 'ff080e778cff797e16e564158e80a033'
send '4d0f321f5d1361bc636201f8fedd87a4'
send '6a80e7f2eeb02a8a0717deaba8619b27'
send 'c0b081e0e45a4314dd44df6d4139f06d'
send '4697e353b26cece2b011284111eef9ea'
send '2dfb7a693560e460012d87f16c096775'
send 'd12ec643183f32b163407c832e8b57c5'
send 'dacbacfa2afbe277bbb259d034425383'
send 'efe2fe65427546757b462dd06864ba3a'
send '4c9d1e0a6afb45d64e20c9e06ad760c2'
send 'dee92a7c3027d17848f802e2fd5569a4'
send 'ac39835c883e92299074f4845cb1547a'
send 'f3e4da54ef592fec70ea4ba85336d5f4'
send 'a95f8ca906e8b0f6441276eecae77039'
send 'a3ca094bff42b6341fc6effe9307bee7'
send 'fcafafcfd60eb77d65c717541377892c'
pause 5

;P
send '2d05e449f1cdfba2602176a59719daee'
send 'b5ce0ec32d1c359ac5b13a811c116c25'
send '13caaa800bbd34a8a881558f1e9590d0'
send 'ae020bcc97ff94cae7f6c6d3a15b7550'
send '7a6842eda2197c9947498612074d6e4a'
send 'e882130977b73f810a25f8ff84ae213b'
send '50099c8368f54ad63fb72dd89c07438e'
send '4cf3e0be2f214ba88a86c2c6a2ef215a'
send '77335f5e91f1853efd3ff6863980efc5'
send '3e354d45fce1a2fc1a72e49ac29cdfaa'
send '5a9866ee58455406cbd6e95310cb75a8'
send '50fbf2fd84299554adfeea06f303642e'

;Q
send 'cc2dfa91c81e3a5e18bf7bc4a0256605'
send '92c31718e3fcf6661d8560da9156a4ff'
send '1fd2e401275d7805f8a90bb64c0c00c1'
send '5e23bab155c6e3b15c68fb5108f5751b'
send '4c79ee31411759910d40c68773a7a84d'
send 'ec371b8cfefa8ebb3139850f33da584a'
send 'e9c7ef194a9259fc28246028e9cc7d8b'
send '00a939dc1c6e347de111050a7361c326'
send '29a00896638ac5de4e438484d749d495'
send 'd50ad59ffa59e2afa82a95c6caf09ec6'
send 'a3facd2eb2674f62fb1899046c9d1f92'
send 'cdc7619fe0ea50d5ee3b1b2fe469d2e6'
pause 5

;e
pause 5
send '00010001'
send 13
pause 5

;n = 256 bytes
send '8e1a97593b3adf945529c78997ed0bca'
send '70b04f410bf64db50c2754a6ad2cb9b7'
send '52d0d5e42a496b00df4a0836b6ae5e80'
send 'e4b4aecde54f556459bdc01c0dc72343'
send 'd32ae8beaf490519e7aa351fbb154b47'
send 'f8e7fa9e29b97e6b0832c35085c20c00'
send 'd4046ed687cd1701348a69de858424aa'
send '3c98b1ca3cab4ae8341aa2f02f786037'
send '94c6c454ac9c6c751fda472250d7efda'
send 'bb84522da75750c044e5105330fdaddc'
send '9ce9fa55e2ffe0f4ddaf8adc1786526e'
send '22a58242f6668a0fcd98b9477e5fe304'
send '626bfb9ed86f5997393fe230f1bb404a'
send '6b5cc69718fa5552c6ae147bf381750d'
send 'c7fcd7e420d150455502408cd0e76367'
send '35ede40f55f946a5b6a643fb9f90f54c'
send 'e7276e2b04f08d1a1759534bbfbeada6'
send '0932c2321b7bc5986c08b3a7ae8b61b4'
send '595ddd16558961a9dc82b0e9f70e0d4c'
send '9ada379f7e7b51a12af6fe2631ac2afb'
send '165ac45cdb329c8c8df45d6b6c412378'
send '2a8f50f69d44bc9fc52a6b92e635bcda'
send '279f1c9e0f90296463762849dd2a0690'
send '73cdba018497a60ea97bf561d8d379d1'
pause 5

pause 10
logclose